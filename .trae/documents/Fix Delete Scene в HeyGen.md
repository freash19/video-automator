## Что сейчас ломается
- Удаление лишних сцен реализовано в двух местах: [scenes.py](file:///Users/ilya/Projects/heygen_automation_V2/core/scenes.py) и [heygen_automation.py](file:///Users/ilya/Projects/heygen_automation_V2/heygen_automation.py#L1089-L1201). В реальном прогоне используется метод класса из heygen_automation.py (вызовы: [heygen_automation.py](file:///Users/ilya/Projects/heygen_automation_V2/heygen_automation.py#L1887-L1902)).
- В обоих вариантах логика кликает «три точки» как `more_button.last`, то есть может попадать не в меню выбранной сцены, а в другую «…» на экране.
- После открытия меню кликается `div[role="menuitem"]` по тексту `Удалить сцену|Delete scene`, но не обрабатывается возможный второй шаг (подтверждение удаления в диалоге) и не валидируется факт удаления.

## Исследование UI (обязательное)
- Прогнать tools/inspector.py на тестовом шаблоне `https://app.heygen.com/create-v4/draft?template_id=0344d8614d484b16a7ab0531560bae91&private=1`.
- В отчёте и annotated.png зафиксировать:
  - контейнер строки сцены (чтобы можно было ограничить поиск «…» именно этой сценой);
  - селектор кнопки «More/…» внутри строки;
  - селектор пункта меню «Delete scene/Удалить сцену»;
  - наличие/селекторы диалога подтверждения и кнопки финального «Delete/Удалить».

## Изменения в коде (после обновления docs/PLAN.md и “Go”)
- Привести удаление к одному источнику правды:
  - либо обновить [HeyGenAutomation.delete_empty_scenes](file:///Users/ilya/Projects/heygen_automation_V2/heygen_automation.py#L1089-L1201) и сделать его делегатом к [core.scenes.delete_empty_scenes](file:///Users/ilya/Projects/heygen_automation_V2/core/scenes.py#L460-L557),
  - либо перенести/встроить устойчивую логику из core/scenes.py в класс и убрать расхождения.
- Сделать клик стабильным:
  - находить сцену по `text_N`, подниматься к контейнеру строки и искать кнопку «…» только внутри этого контейнера (не `last`).
  - клик по «…», пункту «Delete scene» и кнопке подтверждения выполнять через coordinate-click с красной точкой (human_coordinate_click / _show_click_marker).
- Добавить обработку подтверждения:
  - после клика по пункту «Delete scene» ждать диалог/оверлей и нажимать финальную кнопку «Delete/Удалить», если она появилась.
- Добавить валидацию удаления:
  - ждать исчезновения `text_N` (или уменьшения количества сцен) с таймаутом; при провале — падать шагом, чтобы step-wrapper сохранил скриншот.

## Проверка (критерии готовности)
- На тестовом шаблоне лишние сцены (после filled_count) удаляются полностью.
- В automation.log видно последовательность шагов открытия меню → delete → confirm (если есть).
- При любой ошибке сохраняется скриншот в debug/screenshots/.

Если план ок — следующим действием обновлю docs/PLAN.md по этому плану и остановлюсь для вашего “Go” перед правками кода.